# JWT(JSON Web Token)

![JWT](https://ssup2.github.io/images/theory_analysis/JWT/JWT.PNG)

## JWT란
- Json Web Token의 약자로 표준 인터넷 인증 방식 중 하나이다. 유저를 인증하고 식별하기 위해 사용한다.
처음 로그인할 때 서버가 JWT를 생성하여 클라이언트에게 주고난 뒤 유저가 인가가 필요한 어떤 활동을 할 때마다 JWT를 http header에 첨부하면 서버가 JWT를 검증하여 인가를 해준다.

## JWT 인증 과정
- 사용자가 ID, PW를 입력하여 서버에 로그인 인증을 요청한다.

- 서버에서 클라이언트로부터 인증 요청을 받으면, Header, PayLoad, Signature를 정의한다.
Hedaer, PayLoad, Signature를 각각 Base64로 한 번 더 인코딩하여 JWT를 생성하고 이를 쿠키에 담아 클라이언트에게 발급한다.

- 클라이언트는 서버로부터 받은 JWT를 쿠키 또는 다른 방법으로 저장하고 서버에 요청할때 헤더에 Authorization 이라는 키값으로 JWT를 보낸다.

- 서버가 할 일은 클라이언트가 Header에 담아서 보낸 JWT가 내 서버에서 발행한 토큰인지 일치 여부를 확인하여 일치한다면 인증을 통과시켜주고 아니라면 통과시키지 않으면 된다.
- 인증이 통과되면 페이로드에 들어있는 유저의 정보들을 선별하여 클라이언트에 돌려준다.

- 클라이언트가 서버에 요청을 했는데, 만일 액세스 토큰의 시간이 만료되면 클라이언트는 리프래시 토큰을 이용해서 서버로부터 새로운 엑세스 토큰을 발급 받는다.

## JWT의 구조
- header, payload, signature
- 각 요소는 점으로 구분된다. 위 그림에서도 작은 점이 있는데 그게 구분점이다.
- header: 토큰의 타입(JWT)와 적용된 알고리즘(HS256)이 저장된다.

- payload: 사용자 또는 토큰에 대한 속성 정보가 저장된다. 속성 정보란 토큰의 생성시간, 만료시간, 토큰 대상자같은 것들 이다. 페이로드는 인코딩이 될뿐 암호화되는것이 아니기 때문에 민감한 정보를 담지 않는것이 좋으며 식별을 하기 위한 정보만 담는것이 좋다.

- signature: 헤더의 인코딩 값과 페이로드의 인코딩 값을 합친 후 비밀키로 해쉬를 하여 생성된것이다.
알고리즘은 header에서 정의한 것을 사용한다.

- header와 payload는 단순히 인코딩만 된것이라 얼마든지 그 값을 알아낼 수 있지만 시그니처는 서버의 비밀키를 알아야 복호화가 가능하므로 시그니처는 토큰의 위변조 여부를 확인하는데 쓰인다.