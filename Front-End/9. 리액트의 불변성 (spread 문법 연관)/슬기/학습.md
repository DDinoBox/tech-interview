# 리액트의 불변성
사전적 의미의 불변성은 값이나 상태를 변경할 수 없는 것을 뜻하는데, 리액트에서는 메모리 영역에서 값을 변경할 수 없다는 의미입니다. 이는 자바스크립트의 변수 지정과 관련하여 데이터에 대한 이해가 필요합니다.

```javascript
let string = 'data1' // 1. string: 'data1'가 메모리 영역1에 등록됩니다. 
string = 'data2' // 2. string: 'data2'가 메모리 영역2에 등록됩니다.
```

위 예시에서는 총 2개의 메모리 영역을 사용했으며, data2는 data1을 대체하는 것이 아니라 새로운 영역에 할당됩니다.

```javascript
let array = [1, 2, 3, 4] // 메모리영역 1
array.push(5) // 메모리영역 1 

array = [1, 2, 3, 4] // 메모리영역 2 (새로운 참조값)
```
array.push(5)는 원본데이터를 수정함으로써 불변성을 지켜주지 않은 것이 되고,

array = [1, 2, 3, 4] 는 새로운 배열 [1, 2, 3, 4]을 할당하고 새로운 참조 값을 만들어주어 불변성을 지켜준 것이 됩니다.

 # 불변성을 지켜야하는 이유
 리액트가 상태 업데이트를 하는 원리 때문입니다. 리액트는 상태 값을 업데이트할 때 얕은 비교를 수행합니다. 즉, 객체의 속성 값을 하나 하나씩 비교하는게 아니라 참조 값만 비교하여 상태 변화를 감지하는 것입니다. 이런 이유로 배열이나 객체를 업데이트 할 때 setState([...state, newState]), setState({...state, [key]: value}) 이런식으로 배열이나 객체를 새로 생성해서 새로운 참조값을 만들어서 상태를 업데이트합니다.

> #### 얕은 복사와 깊은 복사
> 자바스크립트에서의 복사는 깊은 복사(deep copy) 와 얕은 복사(shallow copy) 가 존재합니다. 원시 타입(primitive type)의 데이터가 복사 될때는 새로운 메모리 공간을 생성하여 메모리에 독립적인 값을 저장하는 반면 object(객체,배열, 함수)와 같은 참조 타입(reference type) 데이터는 애초에 저장 시 데이터에 대한 주소 (힙(Heap) 메모리의 주소값)가 저장되기 때문에 복사 시 값 자체가 아닌, 해당 값을 가리키는 주소가 복사됩니다.

# 불변성의 장점
불변성을 지켜줌으로써 얻는 이점은 사이드 이펙트를 방지하는 것입니다. 외부에 존재하는 원본 데이터를 직접 수정하지 않고, 복사본을 만들어 값을 사용하기 때문에 예상치 못한 오류를 방지할 수 있습니다. 결국 리액트는 불변성을 지킴으로 효과적인 상태 업데이트와 사이드 이펙트 방지 모두 가능합니다.

# 불변성은 어떻게 지킬 수 있는지
새로운 배열을 반환하는 메소드들을 활용하면 됩니다.
> spread operator, map, filter, slice, reduce

setState를 이용할 때 원시타입 경우에는 값을 바로 넣어주어도 되지만 참조타입인 경우에는 새로운 객체나 배열을 생성한 후 값을 넣어주어야 합니다. 

```javascript
// 원시타입
const [number, setNumber] = useState(0)
setState(3)

// 참조타입
const [person, setPerson] = useState({ name: '', age: 30 })
setState({...person, name: 'pyo'})
```