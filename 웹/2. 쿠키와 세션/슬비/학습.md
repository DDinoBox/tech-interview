# 쿠키(Cookie) & 세션(Session)

> 기본적으로 HTTP 프로토콜 환경은 "connectionless, stateless"한 특성을 가지기 때문에 서버는 클라이언트가 누구인지 매번 확인해야 한다. 이를 통해 발생될 수 있는 번거로움을 해결 하기 위한 방법으로 쿠키와 세션을 사용한다. 즉, 정보(데이터)를 유지하기 위해 사용한다.

#### connectionless & stateless ?

1. Connectionless 프로토콜 (비연결지향)

- 클라이언트가 서버에 요청(Request)을 했을 때, 그 요청에 맞는 응답(Response)을 보낸 후 연결을 끊는 처리방식이다.

2. Stateless 프로토콜 (상태정보 유지 안함)

- 통신이 끝나면 상태를 유지하지 않는 특징이다.
- 클라이언트의 상태 정보를 가지지 않는 서버 처리 방식이다. 클라이언트와 첫 번째 통신에서 데이터를 주고 받았다 해도, 두 번째 통신에서 이전 데이터를 유지하지 않는다.

→ 매번 페이지 이동 시 로그인을 다시 해야하거나 상품 선택 후 구매 페이지로 이동 시 상품의 정보가 없거나 하는 등의 일이 발생할 수 있으므로 Stateless 경우를 대처하기 위해 쿠키와 세션을 사용한다.

<br>

#### 공통점

- 웹 통신간 유지하려는 정보(로그인 정보 등)를 저장하기 위해 사용한다.

<br>

#### 차이점

- **저장위치**, 저장형식, 용량제한, 만료시점 등에 차이가 있다.
  쿠키 : 클라이언트(=로컬 PC)에 저장된다.
  세션 : 서버에 저장된다.

![](https://velog.velcdn.com/images/seul06/post/8d97668f-6592-45e4-8721-08e9a09ce713/image.png)

<br>

### 쿠키(Cookie)

- 사용자 정보 파일을 브라우저에 저장한다.
- 쿠키는 클라이언트(브라우저) 로컬에 저장되는 키와 값이 들어있는 작은 데이터 파일이다.
- 사용자 인증이 유효한 시간을 명시할 수 있다. 유효시간이 정해지면 브라우저가 종료되더라도 인증이 유지된다.

- 쿠키는 클라이언트의 상태 정보를 로컬에 저장했다가 참조한다.
- 클라이언트에 300개까지 저장이 가능하고, 하나의 도메인 당 20개의 값만 가질 수 있으며 하나의 쿠키값은 4KB까지 저장한다.
- Response Header에 Set-Cookie 속성을 사용하면 클라이언트에 쿠키를 만들 수 있다.
- 사용자가 따로 요청하지 않아도 브라우저가 Request시에 Request Header를 넣어서 자동으로 서버에 전송한다.

#### 사용 예시

- 방문 사이트에서 로그인 시, '아이디와 비밀번호를 저장하시겠습니까?'
- 쇼핑몰 장바구니 기능
- 자동 로그인
- '오늘 더이상 이 창을 보지 않음' 팝업

<br>

### 세션(Session)

- 세션은 쿠키를 기반하고 있지만, 쿠키와 달리 세션은 서버 측에서 관리한다.
- 서버에서는 클라이언트를 구분하기 위해 세션 ID를 부여하며, 웹 브라우저가 서버에 접속해서 브라우저를 종료할 때까지 인증상태를 유지한다.
  접속 시간에 제한을 두어 일정 시간 응답이 없다면 정보가 유지되지 않도록 설정하는 것도 가능하다.
- 사용자에 대한 정보를 서버에 두므로 쿠키보다 보안에 좋지만, 사용자가 많아질수록 서버 메모리를 많이 차지한다.
  ❗️ 즉, 세션은 서버의 자원을 사용하기 때문에 무분별하게 만들다보면 서버 과부하, 속도가 느려질 수 있기 때문에 쿠키가 유리한 경우가 있다.

- 동시 접속자 수가 많은 사이트의 경우 서버 과부하를 주게 되므로 성능 저하의 요인이 될 수 있다.
- 클라이언트가 Request를 보내면, 해당 서버의 엔진이 클라이언트에게 유일한 ID를 부여하는 데 이것이 세션 ID이다.

#### 사용 예시

- 로그인 같이 보안상 중요한 작업을 수행할 때 사용

✍️ 세션은 사용자의 수 만큼 서버 메모리를 차지하므로 이런 문제를 보완하기 위해 토큰 기반의 인증방식을 사용하는 추세라고 한다.
